<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>EMG Dataset Viewer</title>
  <link rel="shortcut icon" type="image/x-icon" href="icons/title_icon_64x64.png" />
  <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,400" rel="stylesheet"/>

  <link rel="stylesheet" href="css/material_and_icons.css"/>
  <link rel="stylesheet" href="css/material.indigo-pink.min.css"/>
  <link rel="stylesheet" href="css/bootstrap3.3.7.min.css"/>
  <link rel="stylesheet" href="css/nouislider.css"/>

  <link rel="stylesheet" href="css/default.css"/>
  <link rel="stylesheet" href="css/material_design_cards.css"/>
  <link rel="stylesheet" href="css/mdl_expansion_cards.css"/>
  <link rel="stylesheet" href="css/generate_button_styling.css"/>

  <style>
    .gesture-class {
      margin-bottom: 20px;
    }

    .gesture-class h2 {
      margin-bottom: 10px;
    }
    .gesture-row {
      display: flex;
      flex-wrap: wrap;
    }
    .gesture {
      margin-right: 10px;
      text-align: center;
    }
    .gesture img {
      width: 100px;
      height: 100px;
    }
    .gesture img.selected {
      border-color: blue;
    }
    h2{
      font-family: 'Roboto Condensed';
      color: rgb(64,64,64);
      display: inline;
    }
  </style>

  <script>
    //Plugin for Snap for getting the point coordinates while drawing with a mouse
    Snap.plugin( function( Snap, Element, Paper, global ) {
      Element.prototype.getCursorPoint = function( x, y ) {
        var pt = this.paper.node.createSVGPoint();
        pt.x = x; pt.y = y;
        return pt.matrixTransform( this.paper.node.getScreenCTM().inverse());
      }
    });
  </script>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">

  <script type="module">
    import '@material/web/all.js';
    import {styles as typescaleStyles} from '@material/web/typography/md-typescale-styles.js';

    document.adoptedStyleSheets.push(typescaleStyles.styleSheet);
  </script>
  <style>
    form {
      display: flex;
      flex-direction: column;
      align-items: flex-start;
      gap: 16px;
    }
  </style>

</head>
<body>
<header class="mdl-layout__header mdl-layout__header--waterfall">
  <!-- Top row, always visible -->
  <div class="mdl-layout__header-row">
        <span class="mdl-layout-title">
            <img src="icons/tool_icon_v1.png" style="display: inline-block;" height="60" width="150"> &nbsp;&nbsp;
            <h1 style="font-family: 'Roboto Condensed'; color: #fefefe;  display: inline">SparseEMG</h1>
        </span>
    <div class="mdl-layout-spacer"></div>
    <div class="mdl-textfield mdl-js-textfield mdl-textfield--expandable
                  mdl-textfield--floating-label mdl-textfield--align-right">

      <div class="mdl-textfield__expandable-holder">
        <input class="mdl-textfield__input" type="text" name="sample"
               id="waterfall-exp">
      </div>
    </div>
  </div>
  <!-- Bottom row, not visible on scroll -->
</header>

<br/>
<div class="row row-no-gutters">
  <div class="col-sm-3">
<div class="demo-card-shape-customization mdl-card mdl-shadow--2dp">

<h1>Select EMG Dataset</h1>

<h3><select id="datasetSelect">
  <option value="">Select a dataset</option>
  <option value="none">None</option>
  <option value="CSL-HDEMG">CSL-HDEMG</option>
  <option value="Dataset2">Dataset2</option>
  <option value="Dataset3">Dataset3</option>
  <option value="Dataset4">Dataset4</option>
  <option value="Dataset5">Dataset 5</option>
</select></h3>
  <br/>
  <div id="gesture-container"></div>
  </div>
  </div>
<div class="col-sm-6">
  <svg id="drawing" height="400mm" width="350mm" viewBox="0 0 350 400">
  </svg>

</div>
  <div class="col-sm-3">

    <button class="generate_btn" onclick="getSelectedElectrodes()">Generate </button>
    <br/> <br/>

    <button class="generate_btn">Generate For Shape</button>

    <br/> <br/> <br/>

  </div>
</div>

<script>

  var dataset_gestures = new Array();

  document.getElementById('datasetSelect').addEventListener('change', function() {
    const selectedDataset = this.value;
    if (selectedDataset === 'CSL-HDEMG') {
      loadDataset('./datasets/CSL-HDEMG/dataset_metadata.json');
    }
  });

  function loadDataset(jsonFile) {
    fetch(jsonFile)
      .then(response => response.json())
      .then(data => {
        renderGestureImages(data);
      });
  }




  function renderGestureImages(data) {
    const container = document.getElementById('gesture-container');

    data.gesture_classes.forEach(gestureClass => {
      const classDiv = document.createElement('div');
      classDiv.className = 'gesture-class';

      const classTitle = document.createElement('h2');
      classTitle.textContent = gestureClass.class_name;
      classDiv.appendChild(classTitle);

      let gestureRow = document.createElement('div');
      gestureRow.className = 'gesture-row';

      gestureClass.gestures.forEach((gesture, index) => {
        if (index > 0 && index % 5 === 0) {
          classDiv.appendChild(gestureRow);
          gestureRow = document.createElement('div');
          gestureRow.className = 'gesture-row';
        }

        const gestureDiv = document.createElement('div');
        gestureDiv.className = 'gesture';

        const gestureImg = document.createElement('img');
        gestureImg.src = gesture.illustration;
        gestureImg.alt = gesture.gesture_name;
        gestureImg.addEventListener('click', () => {
          dataset_gestures.gesture_name = gesture.gesture_name;
          dataset_gestures.selected = !dataset_gestures.selected;
          console.log(dataset_gestures.gesture_name + dataset_gestures.selected);
        });
        gestureDiv.appendChild(gestureImg);

        const gestureName = document.createElement('p');
        gestureName.textContent = gesture.gesture_name;
        gestureDiv.appendChild(gestureName);

        gestureRow.appendChild(gestureDiv);
      });

      classDiv.appendChild(gestureRow);
      container.appendChild(classDiv);
    });
  }


</script>
</body>
</html>
